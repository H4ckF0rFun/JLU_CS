<svg id="SvgjsSvg4111" width="896.4236111111111" height="1074.4444444444443" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs4112"><marker id="SvgjsMarker4159" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath4160" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker4175" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath4176" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker4221" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath4222" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker4281" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath4282" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker4285" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath4286" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker4289" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath4290" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker4293" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath4294" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker4297" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath4298" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker></defs><g id="SvgjsG4113" transform="translate(155.48611111111111,25.00347222222222)"><path id="SvgjsPath4114" d="M 0 0L 246 0L 246 100L 0 100Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4115"><text id="SvgjsText4116" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="226px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="22.875" transform="rotate(0)"><tspan id="SvgjsTspan4117" dy="16" x="123"><tspan id="SvgjsTspan4118" style="text-decoration:;">hashfile_create:</tspan></tspan><tspan id="SvgjsTspan4119" dy="16" x="123"><tspan id="SvgjsTspan4120" style="text-decoration:;">初始化文件，预先在文件内写入指定大</tspan></tspan><tspan id="SvgjsTspan4121" dy="16" x="123"><tspan id="SvgjsTspan4122" style="text-decoration:;">小的数据。</tspan></tspan></text></g></g><g id="SvgjsG4123" transform="translate(496.9861111111111,146.00347222222223)"><path id="SvgjsPath4124" d="M 0 0L 264 0L 264 97L 0 97Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4125"><text id="SvgjsText4126" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="244px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="13.375" transform="rotate(0)"><tspan id="SvgjsTspan4127" dy="16" x="132"><tspan id="SvgjsTspan4128" style="text-decoration:;">hashfile_saverec：</tspan></tspan><tspan id="SvgjsTspan4129" dy="16" x="132"><tspan id="SvgjsTspan4130" style="text-decoration:;">根据key 计算出hash 作为地址，然后从该</tspan></tspan><tspan id="SvgjsTspan4131" dy="16" x="132"><tspan id="SvgjsTspan4132" style="text-decoration:;">地址开始找到一个未使用数据块存储新的</tspan></tspan><tspan id="SvgjsTspan4133" dy="16" x="132"><tspan id="SvgjsTspan4134" style="text-decoration:;">记录</tspan></tspan></text></g></g><g id="SvgjsG4135" transform="translate(536.9861111111111,365.00347222222223)"><path id="SvgjsPath4136" d="M 0 0L 334 0L 334 132L 0 132Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4137"><text id="SvgjsText4138" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="314px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="30.875" transform="rotate(0)"><tspan id="SvgjsTspan4139" dy="16" x="167"><tspan id="SvgjsTspan4140" style="text-decoration:;">hashfile_findrec:</tspan></tspan><tspan id="SvgjsTspan4141" dy="16" x="167"><tspan id="SvgjsTspan4142" style="text-decoration:;">根据key计算出addr，然后从addr开始往后遍历，在使</tspan></tspan><tspan id="SvgjsTspan4143" dy="16" x="167"><tspan id="SvgjsTspan4144" style="text-decoration:;">用的数据块中找出和参数中指定rec相同那个数据块，</tspan></tspan><tspan id="SvgjsTspan4145" dy="16" x="167"><tspan id="SvgjsTspan4146" style="text-decoration:;">返回这个数据块距离文件起始位置的偏移</tspan></tspan></text></g></g><g id="SvgjsG4147" transform="translate(145.98611111111111,452.00347222222223)"><path id="SvgjsPath4148" d="M 0 0L 265 0L 265 140.390625L 0 140.390625Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4149"><text id="SvgjsText4150" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="245px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="43.0703125" transform="rotate(0)"><tspan id="SvgjsTspan4151" dy="16" x="132.5"><tspan id="SvgjsTspan4152" style="text-decoration:;">hashfile_read:</tspan></tspan><tspan id="SvgjsTspan4153" dy="16" x="132.5"><tspan id="SvgjsTspan4154" style="text-decoration:;">调用hashfile_findrec找到偏移，然后从这</tspan></tspan><tspan id="SvgjsTspan4155" dy="16" x="132.5"><tspan id="SvgjsTspan4156" style="text-decoration:;">个偏移处读取一个数据块</tspan></tspan></text></g></g><g id="SvgjsG4157"><path id="SvgjsPath4158" d="M411.9861111111111 522.1987847222222L485.4861111111111 522.1987847222222L485.4861111111111 431.00347222222223L533.3861111111111 431.00347222222223" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker4159)"></path></g><g id="SvgjsG4161" transform="translate(144.48611111111111,275.00347222222223)"><path id="SvgjsPath4162" d="M 0 0L 268 0L 268 146L 0 146Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4163"><text id="SvgjsText4164" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="248px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="37.875" transform="rotate(0)"><tspan id="SvgjsTspan4165" dy="16" x="134"><tspan id="SvgjsTspan4166" style="text-decoration:;">hashfile_delrec：</tspan></tspan><tspan id="SvgjsTspan4167" dy="16" x="134"><tspan id="SvgjsTspan4168" style="text-decoration:;">调用hashfile_findrec找到要删除rec的</tspan></tspan><tspan id="SvgjsTspan4169" dy="16" x="134"><tspan id="SvgjsTspan4170" style="text-decoration:;">offset，然后将CFtag的 free置为 0 ，减少</tspan></tspan><tspan id="SvgjsTspan4171" dy="16" x="134"><tspan id="SvgjsTspan4172" style="text-decoration:;">CFtag的冲突计数。</tspan></tspan></text></g></g><g id="SvgjsG4173"><path id="SvgjsPath4174" d="M413.4861111111111 348.00347222222223L484.7361111111111 348.00347222222223L484.7361111111111 431.00347222222223L533.3861111111111 431.00347222222223" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker4175)"></path></g><g id="SvgjsG4177" transform="translate(145.98611111111111,155.50347222222223)"><path id="SvgjsPath4178" d="M 0 0L 265 0L 265 78L 0 78Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4179"><text id="SvgjsText4180" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="245px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="19.875" transform="rotate(0)"><tspan id="SvgjsTspan4181" dy="16" x="132.5"><tspan id="SvgjsTspan4182" style="text-decoration:;">hasfile_write:</tspan></tspan><tspan id="SvgjsTspan4183" dy="16" x="132.5"><tspan id="SvgjsTspan4184" style="text-decoration:;">直接调用hashfile_saverec</tspan></tspan></text></g></g><g id="SvgjsG4185" transform="translate(145.98611111111111,714.8003472222222)"><path id="SvgjsPath4186" d="M 0 0L 209 0L 209 307.703125L 0 307.703125Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4187"><text id="SvgjsText4188" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="189px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="29.2265625" transform="rotate(0)"><tspan id="SvgjsTspan4189" dy="16" x="104.5"><tspan id="SvgjsTspan4190" style="text-decoration:;">------ header -------</tspan></tspan><tspan id="SvgjsTspan4191" dy="16" x="104.5"><tspan id="SvgjsTspan4192" style="text-decoration:;">    magic                       </tspan></tspan><tspan id="SvgjsTspan4193" dy="16" x="104.5"><tspan id="SvgjsTspan4194" style="text-decoration:;">    reclen</tspan></tspan><tspan id="SvgjsTspan4195" dy="16" x="104.5"><tspan id="SvgjsTspan4196" style="text-decoration:;">    total_rec_num</tspan></tspan><tspan id="SvgjsTspan4197" dy="16" x="104.5"><tspan id="SvgjsTspan4198" style="text-decoration:;">    current_rec_num</tspan></tspan><tspan id="SvgjsTspan4199" dy="16" x="104.5"><tspan id="SvgjsTspan4200" style="text-decoration:;">    ---------------------</tspan></tspan><tspan id="SvgjsTspan4201" dy="16" x="104.5"><tspan id="SvgjsTspan4202" style="text-decoration:;">    CFTag + char buff[reclen];</tspan></tspan><tspan id="SvgjsTspan4203" dy="16" x="104.5"><tspan id="SvgjsTspan4204" style="text-decoration:;">    ---------------------</tspan></tspan><tspan id="SvgjsTspan4205" dy="16" x="104.5"><tspan id="SvgjsTspan4206" style="text-decoration:;">    CFTag + char buff[reclen];</tspan></tspan><tspan id="SvgjsTspan4207" dy="16" x="104.5"><tspan id="SvgjsTspan4208" style="text-decoration:;">    ---------------------</tspan></tspan><tspan id="SvgjsTspan4209" dy="16" x="104.5"><tspan id="SvgjsTspan4210" style="text-decoration:;">    CFTag + char buff[reclen];</tspan></tspan><tspan id="SvgjsTspan4211" dy="16" x="104.5"><tspan id="SvgjsTspan4212" style="text-decoration:;">    ---------------------</tspan></tspan><tspan id="SvgjsTspan4213" dy="16" x="104.5"><tspan id="SvgjsTspan4214" style="text-decoration:;">    CFTag + char buff[reclen];</tspan></tspan><tspan id="SvgjsTspan4215" dy="16" x="104.5"><tspan id="SvgjsTspan4216" style="text-decoration:;">    ---------------------</tspan></tspan><tspan id="SvgjsTspan4217" dy="16" x="104.5"><tspan id="SvgjsTspan4218" style="text-decoration:;">    ...........</tspan></tspan></text></g></g><g id="SvgjsG4219"><path id="SvgjsPath4220" d="M411.9861111111111 194.50347222222223L453.9861111111111 194.50347222222223L453.9861111111111 194.50347222222223L493.38611111111106 194.50347222222223" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker4221)"></path></g><g id="SvgjsG4223" transform="translate(36.48611111111111,664.0034722222222)"><path id="SvgjsPath4224" d="M 0 0L 119 0L 119 40.5L 0 40.5Z" stroke="none" fill="none"></path><g id="SvgjsG4225"><text id="SvgjsText4226" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="119px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.625" transform="rotate(0)"><tspan id="SvgjsTspan4227" dy="16" x="59.5"><tspan id="SvgjsTspan4228" style="text-decoration:;">hashfile文件结构</tspan></tspan></text></g></g><g id="SvgjsG4229" transform="translate(24.986111111111107,37.39409722222222)"><path id="SvgjsPath4230" d="M 0 0L 100 0L 100 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG4231"><text id="SvgjsText4232" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="100px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="0.875" transform="rotate(0)"><tspan id="SvgjsTspan4233" dy="16" x="50"><tspan id="SvgjsTspan4234" style="text-decoration:;">hasfile操作的实</tspan></tspan><tspan id="SvgjsTspan4235" dy="16" x="50"><tspan id="SvgjsTspan4236" style="text-decoration:;">现</tspan></tspan></text></g></g><g id="SvgjsG4237" transform="translate(427.9861111111111,669.2534722222222)"><path id="SvgjsPath4238" d="M 0 0L 100 0L 100 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG4239"><text id="SvgjsText4240" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="100px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.375" transform="rotate(0)"><tspan id="SvgjsTspan4241" dy="16" x="50"><tspan id="SvgjsTspan4242" style="text-decoration:;">测试程序</tspan></tspan></text></g></g><g id="SvgjsG4243" transform="translate(429.9861111111111,829.5034722222222)"><path id="SvgjsPath4244" d="M 0 0L 96 0L 96 54L 0 54Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4245"><text id="SvgjsText4246" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan4247" dy="16" x="48"><tspan id="SvgjsTspan4248" style="text-decoration:;">main</tspan></tspan></text></g></g><g id="SvgjsG4249" transform="translate(614.9861111111111,697.0034722222222)"><path id="SvgjsPath4250" d="M 0 0L 183 0L 183 60L 0 60Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4251"><text id="SvgjsText4252" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="163px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="19.375" transform="rotate(0)"><tspan id="SvgjsTspan4253" dy="16" x="91.5"><tspan id="SvgjsTspan4254" style="text-decoration:;">Create hash file</tspan></tspan></text></g></g><g id="SvgjsG4255" transform="translate(614.9861111111111,781.5034722222222)"><path id="SvgjsPath4256" d="M 0 0L 183 0L 183 48L 0 48Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4257"><text id="SvgjsText4258" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="163px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="13.375" transform="rotate(0)"><tspan id="SvgjsTspan4259" dy="16" x="91.5"><tspan id="SvgjsTspan4260" style="text-decoration:;">find demo</tspan></tspan></text></g></g><g id="SvgjsG4261" transform="translate(614.9861111111111,854.0034722222222)"><path id="SvgjsPath4262" d="M 0 0L 183 0L 183 38L 0 38Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4263"><text id="SvgjsText4264" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="163px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.375" transform="rotate(0)"><tspan id="SvgjsTspan4265" dy="16" x="91.5"><tspan id="SvgjsTspan4266" style="text-decoration:;">delete deme</tspan></tspan></text></g></g><g id="SvgjsG4267" transform="translate(609.9861111111111,916.5034722222222)"><path id="SvgjsPath4268" d="M 0 0L 183 0L 183 54L 0 54Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4269"><text id="SvgjsText4270" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="163px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan4271" dy="16" x="91.5"><tspan id="SvgjsTspan4272" style="text-decoration:;">read demo</tspan></tspan></text></g></g><g id="SvgjsG4273" transform="translate(609.9861111111111,995.0034722222222)"><path id="SvgjsPath4274" d="M 0 0L 183 0L 183 54L 0 54Z" stroke="rgba(33,41,48,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG4275"><text id="SvgjsText4276" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="163px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan4277" dy="16" x="91.5"><tspan id="SvgjsTspan4278" style="text-decoration:;">write demo</tspan></tspan></text></g></g><g id="SvgjsG4279"><path id="SvgjsPath4280" d="M526.9861111111111 856.5034722222222L570.4861111111111 856.5034722222222L570.4861111111111 727.0034722222222L611.3861111111111 727.0034722222222" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker4281)"></path></g><g id="SvgjsG4283"><path id="SvgjsPath4284" d="M526.9861111111111 856.5034722222222L570.4861111111111 856.5034722222222L570.4861111111111 805.5034722222222L611.3861111111111 805.5034722222222" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker4285)"></path></g><g id="SvgjsG4287"><path id="SvgjsPath4288" d="M526.9861111111111 856.5034722222222L570.4861111111111 856.5034722222222L570.4861111111111 873.0034722222222L611.3861111111111 873.0034722222222" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker4289)"></path></g><g id="SvgjsG4291"><path id="SvgjsPath4292" d="M526.9861111111111 856.5034722222222L567.9861111111111 856.5034722222222L567.9861111111111 943.5034722222222L606.3861111111111 943.5034722222222" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker4293)"></path></g><g id="SvgjsG4295"><path id="SvgjsPath4296" d="M526.9861111111111 856.5034722222222L567.9861111111111 856.5034722222222L567.9861111111111 1022.0034722222222L606.3861111111111 1022.0034722222222" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker4297)"></path></g></svg>